<!doctype html>
<html lang="no">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>xTiber ‚Äì Stats</title>
  <link rel="icon" href="./img/favicon-16x16.png" type="image/png">

  <!-- Global CSS (samme som bayes.html) -->
  <link rel="stylesheet" href="./css/stats.css"> <!-- kun for denne siden -->

  <!-- Vue 3 (CDN) -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>

  <style>[v-cloak] {
      display: none
  }</style>
</head>
<body>
<div id="stats-js" v-cloak>

  <h1>Collected statistics</h1>

  <div v-if="stats.averages.length">
    <p>
      Below are collected statistics for the hypothesis <b>{{ stats.averages[0].title }}</b>. We've tried
      to compress the data as much as possible, to make it easy to get an overview and compare various
      evidences and denominations. The table below is hopefully fairly self-explanatory, but we can point
      out that the percentages in the top header is the movement from "inital gut-feeling" to the "end-result"
      for that particular denomination. The All-column is the average of all denominations.
    </p>
  </div>
  <div v-else>
    <p>
      No statistics available yet! You can help by filling out for the hypotheses and then click the big
      blue button at the bottom of the page that says "Publish your results". You can then choose a "denomination"
      (which includes all kinds of worldviews, not just religious ones) and press the "publish to server" button.
    </p>
  </div>

  <table v-if="stats.averages.length">
    <thead>
    <!-- √òverste header: √©n kolonne pr. denom, men hver spaner 3 underkolonner -->
    <tr>
      <th></th>
      <th v-for="avg in stats.averages"
          :key="avg?.denomination ?? 'denom'"
          colspan="4">
        {{ avg?.denomination ?? 'Unknown' }}
      </th>
    </tr>

    <tr>
      <th></th>
      <template v-for="(avg, aIdx) in stats.averages" :key="'result-'+aIdx">
        <th class="result-header" colspan="4">
          <span>{{ avg?.aprioriPct ?? '' }}%</span>
          <span class="arrow-right">‚û°</span>
          <span>{{ avg?.posteriorPct ?? '' }}%</span>
        </th>
      </template>
    </tr>

    <!-- Underheader: PEH% / PENH% / Weight for hver denom -->
    <tr>
      <th>Evidence</th>
      <template v-for="(avg, aIdx) in stats.averages" :key="'subhdr-'+aIdx">
        <th title="P(E|H)"><span class="arrow-up">‚¨Ü</span></th>
        <th title="P(E|¬¨H)"><span class="arrow-down">‚¨á</span></th>
        <th title="Weight">‚öñÔ∏è</th>
        <th title="Count">üë•</th>
      </template>
    </tr>
    </thead>

    <tbody>
    <!-- Rader styres av f√∏rste average (den har flest evidenser) -->
    <tr v-for="(ev, idx) in (stats.averages[0]?.evidence || [])" :key="ev?.id ?? idx">
      <td>{{ ev?.label ?? `Evidence ${idx + 1}` }}</td>

      <!-- Tre celler per denom: PEH / PENH / Weight -->
      <template v-for="(avg, aIdx) in stats.averages" :key="'r'+idx+'c'+aIdx">
        <td class="num" :class="stats.calcBgColor(avg?.evidence?.[idx])">{{ avg?.evidence?.[idx]?.pehPct ?? '' }}</td>
        <td class="num" :class="stats.calcBgColor(avg?.evidence?.[idx])">{{ avg?.evidence?.[idx]?.penhPct ?? '' }}</td>
        <td class="num" :class="stats.calcBgColor(avg?.evidence?.[idx])">{{ avg?.evidence?.[idx]?.weight ?? '' }}</td>
        <td class="num" :class="stats.calcBgColor(avg?.evidence?.[idx])">{{ avg?.evidence?.[idx]?.count ?? '' }}</td>
      </template>
    </tr>
    </tbody>
  </table>
</div>

<script type="module" src="./js/stats.js"></script>
</body>
</html>
