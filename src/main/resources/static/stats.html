<!doctype html>
<html lang="no">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>xTiber ‚Äì Stats</title>
  <link rel="icon" href="./img/favicon-16x16.png" type="image/png">

  <!-- Global CSS (samme som bayes.html) -->
  <link rel="stylesheet" href="./css/head.css">
  <link rel="stylesheet" href="./css/stats.css">

  <!-- Vue 3 (CDN) -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>

  <style>[v-cloak] {
      display: none
  }</style>
</head>
<body>

<div id="stats-js" v-cloak>

  <div class="header-row">
    <a href="index.html" class="logo-link">
      <img src="./img/favicon-32x32.png" alt="Logo" class="logo-img">
    </a>
    <span class="header-title">Collected statistics</span>
  </div>

  <div v-if="stats.averages.length">
    <p>
      Below are collected statistics for the hypothesis <b>{{ stats.averages[0].title }}</b>. We've tried
      to compress the data as much as possible, to make it easy to get an overview and compare various
      evidences and denominations. Place mouse over the headers to see what they mean. Color-coding is meant
      to indicate which evidences have the most impact on the final result. Green colors means in favor of the
      hypothesis, red means against, and grey means that at least 50% of the answers disregarded that evidence.
    </p>
  </div>
  <div v-else>
    <p>
      No statistics available yet! You can help by filling out for the hypotheses and then click the big
      blue button at the bottom of the page that says "Share results". You must then choose a "denomination"
      (which includes all kinds of worldviews, not just religious ones), review your results (if you want) and
      press another "Share results" button!
    </p>
  </div>

  <table v-if="stats.averages.length">
    <thead>
    <!-- √òverste header: √©n kolonne pr. denom, men hver spaner 3 underkolonner -->
    <tr>
      <th></th>
      <th v-for="avg in stats.averages" :key="avg?.denomination ?? 'denom'" colspan="4"> {{ avg?.denomination ?? 'Unknown' }}</th>
    </tr>

    <tr>
      <th></th>
      <template v-for="(avg, aIdx) in stats.averages" :key="'result-'+aIdx">
        <th class="result-header" colspan="4" title="From inital gut-feeling to final result">
          <span>{{ avg?.aprioriPct ?? '' }}%</span>
          <span class="arrow-right">‚û°</span>
          <span>{{ avg?.posteriorPct ?? '' }}%</span>
        </th>
      </template>
    </tr>
    <tr>
      <th></th>
      <template v-for="(avg, aIdx) in stats.averages" :key="'result-'+aIdx">
        <th colspan="4" title="Number of answers submitted. Some evidences may have been skipped by some users.">
          <span>üë•: {{ avg.count }}</span>
        </th>
      </template>
    </tr>

    <!-- Underheader: PEH% / PENH% / Weight for hver denom -->
    <tr>
      <th>Evidence</th>
      <template v-for="(avg, aIdx) in stats.averages" :key="'subhdr-'+aIdx">
        <th title="Probability (%) of evidence, given hypothesis is true"><span class="arrow-up">‚¨Ü</span></th>
        <th title="Probability (%) of evidence, given hypothesis is false"><span class="arrow-down">‚¨á</span></th>
        <th title="Importance of evidence. 50 is 'normal', and 100 is 'double'. Disregarded evidence is not included, but shown in next column">‚öñÔ∏è</th>
        <th title="Evidence submitted (%) that was disregarded.">‚ùå</th>
      </template>
    </tr>
    </thead>

    <tbody>
    <!-- Rader styres av f√∏rste average (den har flest evidenser) -->
    <tr v-for="(ev, idx) in (stats.averages[0].evidence)" :key="ev.id">
      <td>{{ ev.head }}</td>

      <!-- Tre celler per denom: PEH / PENH / Weight -->
      <template v-for="(avg, aIdx) in stats.averages" :key="'r'+idx+'c'+aIdx">
        <td class="num" :class="stats.calcBgColor(avg?.evidence?.[idx])">{{ avg?.evidence?.[idx]?.pehPct ?? '' }}</td>
        <td class="num" :class="stats.calcBgColor(avg?.evidence?.[idx])">{{ avg?.evidence?.[idx]?.penhPct ?? '' }}</td>
        <td class="num" :class="stats.calcBgColor(avg?.evidence?.[idx])">{{ avg?.evidence?.[idx]?.weight ?? '' }}</td>
        <td class="num" :class="stats.calcBgColor(avg?.evidence?.[idx])">{{ avg?.evidence?.[idx]?.countDisregardPct ?? '' }}</td>
      </template>
    </tr>
    </tbody>
  </table>
</div>

<script type="module" src="./js/stats.js"></script>
</body>
</html>
